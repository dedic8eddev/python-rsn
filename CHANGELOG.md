# Changelog
All notable changes to this project will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),
and this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).

Change log dates is from Tuesday to Tuesday per weekly catch-up meetings.
Since we use butterflies and bees for back, front and mobile releases, we suggest to use 
[saltwater fish names](https://www.roughfish.com/saltwater-fishes) 

for prod deployments :laughing:

## Release version (date)
### Added

### Changed

### Removed

### Fixed

## 0.1.7 (06.03.20223)
### Added
- Image optimization. Used CloudFlare image generation on fly.
- Slugs with translation option.
- Commands for linking venues to Urban Area cities
- OSM names fields to Place model and Urban Area models
- Added readonly option to the fields of venues create/edit page

### Changed
- Image naming
- Slugify functions for Urban Area models
- URLs in CMS for Urban Area feature

### Fixed
- District number on UA city page
- Fixed migrations

## 0.1.6c (24.02.2023)
### Fixed
- Migrations for WP

## 0.1.6c (24.02.2023)
### Fixed
- [Pro Dashboard: Scroll on wine auto-completion list does not work anymore](https://www.notion.so/Pro-Dashboard-Scroll-on-wine-auto-completion-list-does-not-work-anymore-b41172c6708d4a6ea724b162505c1195)

## 0.1.6b (21.02.2023)
### Added
- ['Process images' management command --analyze mode + 'start' and 'limit' args](https://www.notion.so/Image-optimization-create-script-to-monitor-optimization-of-images-44fe1ab9a5af4347af71fbcf5df1b06b)

## 0.1.6a (14.02.2023)
### Changed
- [Optimization ratio](https://www.notion.so/Optimization-ratio-64d9ad47630e43cd8d2f5a6786d62a69)

## 0.1.6 (10.02.2023) (Ballyhoo)
### Added
- [Endpoints for checking available username and email](https://www.notion.so/Endpoints-for-checking-available-username-and-email-9106115cf4e24e34992c81250835f8c8)
- [CMS - add a warning message when transferring from News to Featured venues](https://www.notion.so/CMS-add-a-warning-message-when-transferring-from-News-to-Featured-venues-2f489c072d514ce4a21ff3c223d16d4c)
- [Right panel - owner's tab:add a cross inside text input](https://www.notion.so/Right-panel-owner-s-tab-add-a-cross-inside-text-input-10ac0374e5d14deba7570556ef2e984c)
- [Add confirmation alert when clicking on a status button + corrections on alerts](https://www.notion.so/Add-confirmation-alert-when-clicking-on-a-status-button-corrections-on-alerts-99019e34f3b5424099a85cab7738991b)
- [Reset password: implement IT localization](https://www.notion.so/Reset-password-implement-IT-localization-5f9f431936314646ba4ebaf2d87d2406)
- [Report or Block a user](https://www.notion.so/Report-or-Block-a-user-3022774460324d759afec8754a16935a)
- [Report/flag - CMS: add a section for all reported content from the app](https://www.notion.so/Report-flag-CMS-add-a-section-for-all-reported-content-from-the-app-fbedb47fc8e64f72a22efaf7b43cded1) without subtask [BOTTOM BANNER when selecting an entry](https://www.notion.so/Report-flag-CMS-add-a-section-for-all-reported-content-from-the-app-fbedb47fc8e64f72a22efaf7b43cded1?pvs=4#7ce938d1f8ff43b7b950fc2295983bfe)
### Fixed
- [CMS: When deleting a comment under an event, the comments are still visible on the app](https://www.notion.so/CMS-When-deleting-a-comment-under-an-event-the-comments-are-still-visible-on-the-app-9ca6e81e54e948b8b8015cc25da7485f)
- [Email sent from the app to translate in IT](https://www.notion.so/Email-sent-from-the-app-to-translate-in-IT-50e62110b513440fbd112e0c82c41e3e)
- [CMS: when defining a Referrer and confirm > update the alert displayed.](https://www.notion.so/CMS-when-defining-a-Referrer-and-confirm-update-the-alert-displayed-d83519b00f5547beb37565c15a0d4459)


## 0.1.5a
### Changed
- [Update the Raisin PRO logo on emails to OWNERs + PRO website](https://www.notion.so/Update-the-Raisin-PRO-logo-on-emails-to-OWNERs-PRO-website-cfce4c1970d54675b216a37b3422f227)

## 0.1.5 (Amberjack) (31.01.2023)
### Fixed
- [Pro dashboard: Post 1 wine / Post Food images to turn into buttons](https://www.notion.so/Pro-dashboard-Post-1-wine-Post-Food-images-to-turn-into-buttons-94a2c48662de42e688a846bee063d924)
- [Pro Dashboard: fix localizations for IT](https://www.notion.so/Pro-Dashboard-fix-localizations-for-IT-7bae1fa04ef64dc7b397580a07e31b20)
- [NWLA: excluding a word should also refresh the row status and the total score of the winelist](https://www.notion.so/NWLA-excluding-a-word-should-also-refresh-the-row-status-and-the-total-score-of-the-winelist-098f84d9b03741e397f0264b5af376e3)
- [2 - Wine fair subdomains: test environments are not working anymore](https://www.notion.so/2-Wine-fair-subdomains-test-environments-are-not-working-anymore-8d382424c3364b1aa4abbb11444a5ffd)

---
## 0.1.4 Albacore (26.01.2023)
### Fixed
- [NWLA: Resize table and Item column](https://www.notion.so/NWLA-Resize-table-and-Item-column-3b93ba2aba1048e4ae029ec2581b033a)
- [NWLA - Thickbox changes + alert box when excluding a word](https://www.notion.so/NWLA-Thickbox-changes-alert-box-when-excluding-a-word-9d897115a21a4c95a539fb5c51dbc589)
- [CMS: correct label “Pictures from this venue”](https://www.notion.so/CMS-correct-label-Pictures-from-this-venue-1f78255002f5402190e8de72cbc3259c)
- [Pro Dashboard: html tags appearing in the description](https://www.notion.so/Pro-Dashboard-html-tags-appearing-in-the-description-e026ed230e504aba909c770e3996b6e9)
- [CMS: when clicking on a wine list, window scrolls to the top](https://www.notion.so/CMS-when-clicking-on-a-wine-list-window-scrolls-to-the-top-54389528cf7243518792fb7c9ce6d300)

---
## 0.1.3a (17.01.2023)
### Fixed
- long request execution `api/autocomplete/wine`
- long request execution `api/autocomplete/winemaker`

___
## 0.1.3 (27.12.2022)
### Changed 
- [NWLA Script Refactor](https://www.notion.so/NWLA-Script-Refactor-5bbdf29f99754245815cfd0f86085272)
- [Step-by-step processing rules](https://www.notion.so/Step-by-step-processing-rules-46ba44d0bfc648e99400b5254dca2862)
- [Advanced NWLA optimisations](https://www.notion.so/Advanced-NWLA-optimisations-e8da2cf4e5354fa6a9df948eb8f4695b)
- [Remove extra spaces + prices](https://www.notion.so/Remove-extra-spaces-prices-5d458e58652347f6a8676af9df6ba7e7)
- [NWLA](https://www.notion.so/NWLA-a126891125a740ce8f03684fdff7adfe) 

### Added 
- [New excluding page](https://www.notion.so/New-excluding-page-f327b25c69984e65a7ebc134d699e5c7)
- [New OCR tab](https://www.notion.so/New-OCR-tab-b0711675ccdc45debc6d55549651a0cd)
- [NWLA: add file name as the thickbox’s title](https://www.notion.so/NWLA-add-file-name-as-the-thickbox-s-title-1d5b3456d1fb45378ae2256792b7f65f)
- [NWLA: Recalculate the wine score automatically](https://www.notion.so/NWLA-Recalculate-the-wine-score-automatically-fd3738800c0a4213bf89deda4c28d8ac) 
- [NWLA: add a numbered column to the left](https://www.notion.so/NWLA-add-a-numbered-column-to-the-left-541729ac48434660a6e903624166be2b)
- [Refresh results when excluding a word](https://www.notion.so/Refresh-results-when-excluding-a-word-241fff952de24636a0a34f2b35488da1)
- [Wine score: Skip OCR treatment for these files](https://www.notion.so/Wine-score-Skip-OCR-treatment-for-these-files-c93f7d4ff15344608baec4a1c46efa19)
- [Wine score: special characters patterns to define](https://www.notion.so/Wine-score-special-characters-patterns-to-define-17194544bb234254bfa679cfe37ef88c)
- [OCR tab - Excluded keywords: add a clear button on the search field](https://www.notion.so/OCR-tab-Excluded-keywords-add-a-clear-button-on-the-search-field-a25b54f8b7d74c6dbc3fc69d858943ba)

### Fixed
- [CMS: On the "naturals" + "others" subtabs: pagination is broken and we cannot access other pages than page 1](https://www.notion.so/CMS-On-the-naturals-others-subtabs-pagination-is-broken-and-we-cannot-access-other-pages-tha-516c5c66557d4948be9ab170f4e22828)
- [Duplicate issue: update solution](https://www.notion.so/Duplicate-issue-update-solution-4cee1b902997409ab03ec7f31fb822f0)
- [CMS: on Admin page, Places reviewed are not showing up and loading goes on forever without displaying anything](https://www.notion.so/CMS-on-Admin-page-Places-reviewed-are-not-showing-up-and-loading-goes-on-forever-without-displayin-958cba3a29c24205b7d0e2aa721d9e19)
- [Unique ID missing for pictures on the Pro Dashboard](https://www.notion.so/Unique-ID-missing-for-pictures-on-the-Pro-Dashboard-6fa8737351bc4ebb9bef21e6cdd06e4d)
- [Right panel: the right panel closes itself while moderating data](https://www.notion.so/Right-panel-the-right-panel-closes-itself-while-moderating-data-b7289b682cea4e579bf61eb28a4fad60)
- [New relic alert: error on css file (/static/assets/stylesheets/skin.min.css.map)](https://www.notion.so/New-relic-alert-error-on-css-file-static-assets-stylesheets-skin-min-css-map-2eceaa61119e4d26af13a5e7662114d3)

## 0.1.2 (21.12.2022)

### Added 
- Add ability to block and report user ([Mobile](https://www.notion.so/Report-flag-Android-UGC-mandatory-features-to-add-by-December-14th-ddcd7dcc7621465db9e140e8414b6899)) ([CMS](https://www.notion.so/Report-flag-CMS-add-a-section-for-all-reported-comments-on-the-app-fbedb47fc8e64f72a22efaf7b43cded1))
- Add customizing OrderFilter, SearchFilter, Pagination for using with DataTables.js plugin
- Add 404 error for `/api/users/any/get` endpoint if gotten user have been blocked requesting user. 

### Fixed 
- Authentication method in the `/api/users/any/get` endpoint. All requests executed as anonymous 

## 0.1.1 (14.12.2022)

### Added 
- Add Report System ([Mobile](https://www.notion.so/Report-flag-Android-UGC-mandatory-features-to-add-by-December-14th-ddcd7dcc7621465db9e140e8414b6899)) ([CMS](https://www.notion.so/Report-flag-CMS-add-a-section-for-all-reported-comments-on-the-app-fbedb47fc8e64f72a22efaf7b43cded1))

## 0.1.0 (01.12.2022)

### Fixed

- [Pictures are not saved when submitting a venue](https://www.notion.so/Pictures-are-not-saved-when-submitting-a-venue-2943773c65bc434c9f5dea87c232bce0)
- [Error/crash while searching for an event on the app.](https://www.notion.so/Error-crash-while-searching-for-an-event-on-the-app-f545351a4ac345358e38345d4c4f12f9)

## 2021-03-10 - 2021-03-16
### Added
- Add `GET api/winemakers/<id>` endpoint API to get specific winemaker detailed information 
- Add `GET api/winemakers` endpoint API to get a list of winemakers for winemakers mobile screen 
- Add `GET api/places/<id>` endpoint API to get specific place detailed information
- Add `GET api/places` endpoint API to get a list of places needed for places geo mobile screen
- Add conversion to .jpg format option in `process_images` cli command
- Add image optimization
### Changed
- Speedup `api/winemaker/items` endpoint API from 30+ seconds down to 1 second
- Reduce images weight to 67%

### Fixed
- Fix `wine_kind` data type for place related endpoints API

## 2021-03-04 - 2021-03-09
### Added
- Optimize vuforia, label, posted by user images on winepost edit page.
- Add logic to get post square image url for CMS
- Speedup loading parent/nonparent winepost page. 
- Add `app_winemaker_display_statuses` variable to display winemakers on mobile app 
### Changed
- Rework back-end logic for mobile winemakers screen. 
### Removed

### Fixed
- Fix `wine_kind` field type for `api/places/place/all-wines` and `/api/places/wines-foods-closest-venues` APIs
- Fix vuforia refresh image rating 
- Fix `drunk_it_toos` return value
- Fix duplicates for `/api/winemaker/items` endpoint API 

## 2021-02-24 - 2021-03-02
### Added
- Implement status inheritance for freshly created `Parent/Referrer` winepost  from Winemaker's status 
- Add find wines endpoints API final SQL logging

### Changed
- Change `HIDDEN` wine posts to `NATURAL`
### Removed

### Fixed
- Fix NWLA algorithm crash in case when winemaker has no wines
- Fix vuforia DEV database and scanning label issue
- Fix find wines filtering and display `IN_DOUBT`, `PUBLISHED` and `BIO_ORGANIC` wine posts instead only `PUBLISHED`

## 2021-02-17 - 2021-02-23
### Added
- Add additional filtering of wine posts to not display not Natural wine posts in `/api/find-wineposts`, 
`/api/find-wineposts/geolocated`, `/api/find-wineposts-filtered/geolocated` endpoints API
- Add case to `/api/find-wineposts-filtered/geolocated` API to return empty list when all buttons unselected
- Add `is_subscribing` new field to `VenueSerializer` class with proper meaning  
### Changed
- Increase badge icons from 20x20px to 60x60px.
- Update find wines filtering logic for scanned image in `/api/find-wineposts-filtered/geolocated` API. 
- When filter button is tapped - get only wine posts includes filter value
- When filter button is untapped - get wine posts excluding wine posts that contains filter value 
### Removed

### Fixed
- Fix situation when filter is absent but selection = True. Force to unselect filter when filter is not present.

## 2021-02-10 - 2021-02-16
### Added
- Add ability to select winemakers with status `TO_INVESTIGATE` in the parent post selector
- Add `get_datetime_human(dt)` datetime utility function to get human readable datetime representation with correct
formatting
### Changed
- Extend nested `wine` object in `WinepostSerializer` with `i_like_it` & `i_drank_it_too` fields
- Run image optimization on `prod` server. Update `_tmb` type of images, remove white borders if any, 
resize thumbs to 400x400 px. Create new `_square` type of image with 260x260 px.  
### Removed
- Remove `/api/closest-wines` endpoint API
- Remove `/api/closest-wines-filtered` endpoint API
### Fixed
- Fix french datetime formatting for `modified_time_human` field and escape unused in France 'E' after date number
- Fix subscription ordering, exclude `CANCELED` subscription status from venues with subscription.
- Fix prioritizing: first owners with subscription, then geolocated and then users wine posts.


## 2021-02-03 - 2021-02-09
### Added
- Add app wineposts data manager `AppWinepostsManager` class
- Add error handling & logging for `/api/find-wineposts` & `/api/find-wineposts/geolocated` endpoints API 
- Add `/api/find-wineposts` endpoint API to get all wineposts sorted by distance and order with subscription first
- Add `/api/find-wineposts/geolocated` endpoint API to get all geolocated wineposts
 sorted by distance and order with subscription first

### Fixed
- Fix displaying empty data venues with incorrect status on mobile application
- Fix status object for winepost `status` field
- Exclude possibility of mobile unsupported status `badge` issue

## 2021-01-27 - 2021-02-02
### Added
- Add wineposts set `TO_INVESTIGATE` ajax endpoint API: `/ajax/wineposts/set_to_investigate`
- Add winemakers set `TO_INVESTIGATE` ajax endpoint API: `/ajax/winemakers/set_to_investigate`
- Add ability to search winemakers with 'TO_INVESTIGATE' status
- Add database extraction queries to `db_extraction.sql` file in `/web/utils` directory
- Add ability to change winemaker status to 'TO_INVESTIGATE'
- Add ability to change parent post / wine post status to 'TO_INVESTIGATE'
- Add html formatting for new 'TO_INVESTIGATE' status
- Add `WinemakerHelper` & `WinepostHelper` classes

### Changed
- Display only with `IN DOUBT, NATURAL, NOT NATURAL, BIO/ORGANIC` posts statuses  
for `api/closest-wines` & `api/closest-wines-filterd` APIs
- Display only with `PUBLISHED` status venues for `api/closest-wines` & `api/closest-wines-filterd` APIs
- Updated `/place/edit/{id}` API to remove cache for moderated place object
- Update docs for new and investigated functions
- Format winemaker status to HTML moved to `formatting.py`
- Format place status to HTML moved to `formatting.py`
### Fixed
- Fix filtering deleted posts in `api/closest-wines` & `api/closest-wines-filterd` APIs
- Fix address wasn't updated on mobile when updating it from the CMS
- Exclude wine posts with status `DELETED` from find wine posts venues endpoints API 

## 2021-01-19 - 2021-01-26
### Added
- Database extraction : natural winemakers information
- Add Find wines filtered endpoint API `/api/closest-wines-filtered`

### Changed
- Complete applying images optimization
- Change Find wine posts venues queryset sort ordering: first places with subscription by distance, 
second with no subscription by distance  

### Fixed
- Notification : URL of image is displayed instead of the wine's name 

## 2021-01-11 - 2021-01-17
### Added
- Add CLI.md documentation
- Implemented ability to find wines based on: `wine name` + `Winemaker’s Name` + `Domain Name` 
- Implemented Get closest wines API `/api/closest-wines`
 
### Changed
- Prioritize venues wines with subscription first
- Exclude `CLOSED` places from `/api/closest-wines` result set

### Fixed
- Fix `badge` for DRAFT venue status
- Fix sorting ordering in `/api/closest-wines' API

## 2021-01-04 - 2021-01-10
### Added
- New square type of images: `image_name_square.jpg` with 260x260px size  
- New cli command to re-process images: `python manage.py process_images --help`
### Changed
- `ref_image` from `/api/closest-wines` response changed to `thubm_image`
 
### Fixed
- Fixed `_tmb` thumbs images

## 2020-12-28 - 2021-01-03
### Added
- Add `winemaker_id` to response object in `/api/closest-wines` endpoint API
- Add DB installation instructions
### Changed

### Removed
- Remove `tap_number` from `/api/closest-wines` response object

### Fixed
- Fix representation for `id`, `post_id` fields from string to integer type in `/api/closest-wines` endpoint API
- Fix duplicate records appearing in response of `/api/closest-wines` endpoint API

## 2020-12-21 - 2020-12-27

### Added
- Add `IMAGES.md` documentation file

### Fixed
- Remove transparency for newly uploaded square thumbnail images
- Resize landscape newly uploaded images to square thumbnail 
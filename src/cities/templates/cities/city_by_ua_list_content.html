{% load static %}

<div class="table table-striped vmiddle" style="font-size:14px;">

<!-- 32.4. $BOOTSTRAP_DATEPICKER_RANGE ============================================================= user.html Range -->

    <div role="grid" id="jq-datatables-example_wrapper" class="dataTables_wrapper form-inline no-footer">
        <div class="table-header clearfix">
            <div class="table-caption">
                <a href="{% url 'continent_list' %}">CONTINENTS</a> -
                <a href="{% url 'country_list' code=continent_code %}">{{ country.continent.name }}</a> -
                <a href="{% url 'region_list' continent_code=continent_code country_slug=country.slug %}">{{ country.name }}</a> -
                <a href="{% url 'ua_cities_list' continent_code=continent_code country_slug=country.slug slug=region.slug %}">{{ region.name }}</a> -
                {{ urban_area_name }} : Cities
            </div>
            <div class="DT-lf-right">
                <div class="DT-per-page">
                    <div class="dataTables_length" id="jq-datatables-example_length">
                        <label>Per page:
                            <select name="jq-datatables-example_length" aria-controls="jq-datatables-example" class="form-control input-sm" onchange="javascript:handleSelect(this)">
                                <option value="10" {% if page_size == "10" %}selected{% endif %}>10</option>
                                <option value="25" {% if page_size == "25" %}selected{% endif %}>25</option>
                                <option value="50" {% if page_size == "50" %}selected{% endif %}>50</option>
                                <option value="100" {% if page_size == "100" %}selected{% endif %}>100</option>
                            </select>
                        </label>
                    </div>
                </div>
                <div class="DT-search-cities-autocomplete">
                    <div id="jq-datatables-example_filter" class="dataTables_filter">
                        <label>
                            <input
                                id="autocomplete"
                                type="text"
                                name="search"
                                class="form-control input-sm"
                                aria-controls="jq-datatables-example"
                                placeholder="Search..."
                                value="{{ search_name|default:'' }}"
                            >
                        </label>
                    </div>
                </div>
            </div>
        </div>
    <table cellpadding="0" cellspacing="0" border="0" class="table table-striped table-bordered dataTable no-footer" id="jq-datatables-example" aria-describedby="jq-datatables-example_info">
        <thead>
            <tr role="row">
{#                <th style="width: 14px;" class="sorting_asc" tabindex="0" aria-controls="jq-datatables-example" rowspan="1" colspan="1" aria-sort="ascending" aria-label=": activate to sort column ascending"><br><input type="checkbox" id="toggle-all" name="check-all"></th>#}
                <th style="width: 73px;" class="" tabindex="0" aria-controls="jq-datatables-example" rowspan="1" colspan="1" aria-label="Picture: activate to sort column ascending">Picture</th>
                <th
                    class="{% if '-updated_at' in order_by %}sorting_asc{% elif 'updated_at' in order_by %}sorting_desc{% else %}sorting{% endif %}"
                    tabindex="0"
                    aria-controls="jq-datatables-example"
                    rowspan="1"
                    colspan="1"
                    aria-label="Date: activate to sort column ascending"
                    style="width: 242px;"
                    data-ordering="{% if '-updated_at' in order_by %}updated_at{% else %}-updated_at{% endif %}"
                    onclick="javascript:handleOrdering(this)"
                >Date</th>
                <th class="" tabindex="0" aria-controls="jq-datatables-example" rowspan="1" colspan="1" aria-label="Author: activate to sort column ascending" style="width: 124px;">Author</th>
                <th
                    class="{% if '-name' in order_by %}sorting_asc{% elif 'name' in order_by %}sorting_desc{% else %}sorting{% endif %}"
                    tabindex="0"
                    aria-controls="jq-datatables-example"
                    rowspan="1"
                    colspan="1"
                    aria-label="Cities: activate to sort column ascending"
                    style="width: 257px;"
                    data-ordering="{% if '-name' in order_by %}name{% else %}-name{% endif %}"
                    onclick="javascript:handleOrdering(this)"
                >Cities</th>
                <th>Districts</th>
                <th
                    class="{% if '-venues_count' in order_by %}sorting_asc{% elif 'venues_count' in order_by %}sorting_desc{% else %}sorting{% endif %}"
                    tabindex="0"
                    aria-controls="jq-datatables-example"
                    rowspan="1"
                    colspan="1"
                    aria-label="Nbr of Venues: activate to sort column ascending"
                    style="width: 231px;"
                    data-ordering="{% if '-venues_count' in order_by %}venues_count{% else %}-venues_count{% endif %}"
                    onclick="javascript:handleOrdering(this)"
                >Nbr of Venues</th>
                <th tabindex="0" aria-controls="jq-datatables-example" rowspan="1" colspan="1" aria-label="Urban Areas &amp;amp; Cities: activate to sort column ascending" style="width: 325px;">Venues</th>
                <th tabindex="0" aria-controls="jq-datatables-example" rowspan="1" colspan="1" aria-label="EN: activate to sort column ascending" style="width: 62px;">EN</th>
                <th tabindex="0" aria-controls="jq-datatables-example" rowspan="1" colspan="1" aria-label="FR: activate to sort column ascending" style="width: 61px;">FR</th>
                <th tabindex="0" aria-controls="jq-datatables-example" rowspan="1" colspan="1" aria-label="JA: activate to sort column ascending" style="width: 61px;">JA</th>
                <th tabindex="0" aria-controls="jq-datatables-example" rowspan="1" colspan="1" aria-label="IT: activate to sort column ascending" style="width: 61px;">IT</th>
                <th tabindex="0" aria-controls="jq-datatables-example" rowspan="1" colspan="1" aria-label="ES: activate to sort column ascending" style="width: 61px;">ES</th>
            </tr>
        </thead>
        <tbody>
            {% for object in object_list %}
                <tr class="gradeA odd" id="c-tooltips-demo">
{#                    <td class="sorting_1"><input type="checkbox" id="colors-1-toggle-0" name="colors-1[]" value="color_c"></td>#}
                     <td>
                        {% if object.image %}
                            <img
                                src="{{ object.get_image_url }}"
                                alt="{{ object.name }}"
                                width="45"
                                height="45"
                            >
                        {% else %}
                            <img
                                src="{% static 'cities/images/untitled.png' %}"
                                alt="{{ object.name }}"
                                width="45"
                                height="45"
                            >
                        {% endif %}
                        </a>
                    </td>
                    <td class="text-left">{{ object.updated_at }}</td>
                    <td class="picture-small">
                        {% if object.author %}
                            {% if object.author.image %}
                                <img src="{{ object.author.get_image_url }}"
                                    data-toggle="tooltip"
                                    title="{{ object.author.name }}"
                                    data-placement="bottom"
                                    data-original-title="{{ object.author.name }}"
                                >
                            {% else %}
                                <img src="https://cms.raisin.digital/static/assets/img/missing.gif"
                                    data-toggle="tooltip"
                                    title="{{ object.author.name }}"
                                    data-placement="bottom"
                                    data-original-title="{{ object.author.name }}"
                                >
                            {% endif %}
                        {% else %}
                            -
                        {% endif %}
                    </td>
                    <td class="text-center bold">{{ object.name }}</td>
                    <td class="text-center">
                        {% if object.district_count and object.admin_level %}
                            <a href="{% url 'district_list' continent_code=continent_code country_slug=country_slug region_slug=object.region.slug city_slug=object.slug %}">
                                {{ object.district_count }}
                            </a>
                        {% else %}
                            -
                        {% endif %}
                    </td>
                    <td class="text-center"><span class="label label-flat label-default none">{{ object.venues_count }}</span></td>
                    <td class="text-center">
                        <a href="{% url 'venues_by_ua_city_list' continent_code=continent_code country_slug=country_slug region_slug=region.slug name=urban_area_name slug=object.slug%}" class="grayici" data-toggle="tooltip" title="" data-placement="bottom" data-original-title="Venues Listed In This Town"> <i class="fa fa-sign-in"></i> </a>
                    </td>
                    <td><a href="{% url 'city_update' code=continent_code country_slug=object.country.slug region_slug=region.slug slug=object.slug language='en' %}" class="{% if object.published_en %}success{% else %}incomplete{% endif %}" data-toggle="tooltip" title="" data-placement="bottom" data-original-title="Draft"> <i class="fa fa-edit"></i>{#% for an in object.alt_name_codes %} {{ an }} {% endfor % </a></td>#}
                    <td><a href="{% url 'city_update' code=continent_code country_slug=object.country.slug region_slug=region.slug slug=object.slug language='fr' %}" class="{% if object.published_fr %}success{% else %}incomplete{% endif %}" data-toggle="tooltip" title="" data-placement="bottom" data-original-title="Published"> <i class="fa fa-edit"></i>  </a></td>
                    <td><a href="{% url 'city_update' code=continent_code country_slug=object.country.slug region_slug=region.slug slug=object.slug language='ja' %}" class="{% if object.published_ja %}success{% else %}incomplete{% endif %}" data-toggle="tooltip" title="" data-placement="bottom" data-original-title="Draft"> <i class="fa fa-edit"></i> </a></td>
                    <td><a href="{% url 'city_update' code=continent_code country_slug=object.country.slug region_slug=region.slug slug=object.slug language='it' %}" class="{% if object.published_it %}success{% else %}incomplete{% endif %}" data-toggle="tooltip" title="" data-placement="bottom" data-original-title="Published"> <i class="fa fa-edit"></i>  </a></td>
                    <td><a href="{% url 'city_update' code=continent_code country_slug=object.country.slug region_slug=region.slug slug=object.slug language='es' %}" class="{% if object.published_es %}success{% else %}incomplete{% endif %}" data-toggle="tooltip" title="" data-placement="bottom" data-original-title="Draft"> <i class="fa fa-edit"></i> </a></td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
    {% include "cities/pagination.html" %}
</div>
<script type="text/javascript">
    function handleSelect(elm)
    {
        search_name = document.getElementById('autocomplete')
        if (!search_name.value){
            window.location = '?page_size='+elm.value;
        }
        window.location = '?name='+search_name.value+'&page_size='+elm.value;
    }
    function handleOrdering(elm)
    {
        search_name = document.getElementById('autocomplete')
        page_size = {{ page_size }}
        if (search_name) {
            window.location = '?name='+search_name.value+'&page_size='+page_size+"&order_by="+elm.dataset.ordering;
        }
        else {
            window.location = '&page_size='+page_size+'&order_by='+elm.dataset.ordering;
        }
    }
</script>
